(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8300],{889:(s,a,e)=>{Promise.resolve().then(e.bind(e,27358))},27358:(s,a,e)=>{"use strict";e.r(a),e.d(a,{default:()=>m});var o=e(95155),r=e(12115),i=e(35695),t=e(52548),l=e(91218),d=e(57141),n=e(55887);e(77582),e(65775),e(43636);var c=e(9690);function m(){let{t:s}=(0,l.Bd)(),a=(0,i.useRouter)(),{message:e}=n.A.useApp(),[m,f]=(0,r.useState)({email:"",verificationCode:"",password:"",confirmPassword:""}),[u,h]=(0,r.useState)(!1),[g,P]=(0,r.useState)(!1),[x,v]=(0,r.useState)(!1),[j,N]=(0,r.useState)({email:"",verificationCode:"",password:"",confirmPassword:""}),F=s=>{let{name:a,value:e}=s.target;f(s=>({...s,[a]:e})),j[a]&&N(s=>({...s,[a]:""}))},y=a=>{let{name:e,value:o}=a.target;if(o.trim())"email"!==e||/\S+@\S+\.\S+/.test(o)?"password"===e&&o.length<6?N(a=>({...a,[e]:s("ForgotPassword.validation.passwordMinLength","Password must be at least 6 characters")})):"confirmPassword"===e&&o!==m.password?N(a=>({...a,[e]:s("ForgotPassword.validation.passwordMismatch","Passwords do not match")})):N(s=>({...s,[e]:""})):N(a=>({...a,[e]:s("ForgotPassword.validation.emailInvalid","Please include a valid email address")}));else{let a=s("ForgotPassword.".concat(e),e.charAt(0).toUpperCase()+e.slice(1));N(o=>({...o,[e]:"".concat(a," ").concat(s("ForgotPassword.validation.required","is required"))}))}},C=async()=>{if(!m.email.trim())return void N(a=>({...a,email:s("ForgotPassword.validation.emailRequired","请输入邮箱地址")}));if(!/\S+@\S+\.\S+/.test(m.email))return void N(a=>({...a,email:s("ForgotPassword.validation.emailInvalid","请输入有效的邮箱地址")}));try{P(!0);let a=await fetch("".concat(d.H$,"api/forgot-password/send-code"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:m.email})});if(a.ok)v(!0),e.success(s("ForgotPassword.codeSent","验证码已发送，请查收邮箱"));else try{let o=await a.json();e.error(o.message||s("ForgotPassword.codeSendFailed","验证码发送失败，请重试"))}catch(a){console.error("解析错误响应失败:",a),e.error(s("ForgotPassword.codeSendFailed","验证码发送失败，请重试"))}}catch(a){console.error("发送验证码失败:",a),e.error(s("ForgotPassword.codeSendFailed","验证码发送失败，请重试"))}finally{P(!1)}},S=async()=>{try{h(!0);let o=await fetch("".concat(d.H$,"api/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:m.email,password:m.password,password_confirmation:m.confirmPassword,verification_code:m.verificationCode})});if(o.ok)await o.json(),e.success(s("ForgotPassword.success","密码重置成功！")),a.push("/login");else try{let a=await o.json();e.error(a.message||s("ForgotPassword.failed","密码重置失败，请重试"))}catch(a){console.error("解析错误响应失败:",a),e.error(s("ForgotPassword.failed","密码重置失败，请重试"))}}catch(a){console.error("密码重置失败:",a),e.error(s("ForgotPassword.failed","密码重置失败，请重试"))}finally{h(!1)}};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(c.FormHeader,{}),(0,o.jsx)("div",{className:"my-5",children:(0,o.jsx)("div",{className:"container",children:(0,o.jsx)("div",{className:"row",children:(0,o.jsx)("div",{className:"col",children:(0,o.jsx)("div",{className:"row mt-20 contact-details",children:(0,o.jsx)("div",{className:"col",children:(0,o.jsx)("form",{id:"forgot-password-form",onSubmit:a=>{a.preventDefault(),(()=>{let a={email:"",verificationCode:"",password:"",confirmPassword:""},e=!0;if(m.email.trim())/\S+@\S+\.\S+/.test(m.email)||(a.email=s("ForgotPassword.validation.emailInvalid","Please include a valid email address"),e=!1);else{let o=s("ForgotPassword.email","Email address");a.email="".concat(o," ").concat(s("ForgotPassword.validation.required","is required")),e=!1}if(!m.verificationCode.trim()){let o=s("ForgotPassword.verificationCode","Verification Code");a.verificationCode="".concat(o," ").concat(s("ForgotPassword.validation.required","is required")),e=!1}if(m.password.trim())m.password.length<6&&(a.password=s("ForgotPassword.validation.passwordMinLength","Password must be at least 6 characters"),e=!1);else{let o=s("ForgotPassword.password","New Password");a.password="".concat(o," ").concat(s("ForgotPassword.validation.required","is required")),e=!1}if(m.confirmPassword.trim())m.confirmPassword!==m.password&&(a.confirmPassword=s("ForgotPassword.validation.passwordMismatch","Passwords do not match"),e=!1);else{let o=s("ForgotPassword.confirmPassword","Confirm Password");a.confirmPassword="".concat(o," ").concat(s("ForgotPassword.validation.required","is required")),e=!1}return N(a),e})()?S():console.log("表单验证失败，请检查输入内容")},children:(0,o.jsx)("div",{"data-classification":"contact-details","data-type":"contact-details",className:"formulate-input",children:(0,o.jsx)("div",{className:"formulate-input-wrapper",children:(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("div",{className:"col-12",children:(0,o.jsx)("h3",{className:"text-medium",children:s("ForgotPassword.title","Reset Your Password")})}),(0,o.jsx)("div",{className:"col-11 col-md-7 col-lg-4 mt-4",children:(0,o.jsx)("span",{children:(0,o.jsxs)("div",{"data-classification":"text","data-type":"text",className:"formulate-input","data-has-errors":!!j.email,"data-is-showing-errors":!!j.email,children:[(0,o.jsxs)("label",{htmlFor:"email",className:"formulate-input-label",children:[s("ForgotPassword.email","Email address")," *"]}),(0,o.jsxs)("div",{className:"d-flex",children:[(0,o.jsx)("input",{autoComplete:"off",type:"email",name:"email",value:m.email,onChange:F,onBlur:y,placeholder:s("ForgotPassword.placeholders.email","e.g. example@gmail.com"),className:"formulate-input formulate-input-element flex-grow-1",style:{marginRight:"10px"}}),(0,o.jsx)("button",{type:"button",className:"btn btn-outline-primary",style:{whiteSpace:"nowrap",color:"#fff"},onClick:C,disabled:g||x,children:g?s("ForgotPassword.sending","发送中..."):x?s("ForgotPassword.codeSent","已发送"):s("ForgotPassword.getCode","获取验证码")})]}),(0,o.jsx)("ul",{className:"formulate-input-errors",children:j.email&&(0,o.jsx)("li",{className:"formulate-input-error",children:"string"==typeof j.email?j.email:JSON.stringify(j.email)})})]})})}),(0,o.jsx)(p,{}),(0,o.jsx)("div",{className:"col-11 col-md-7 col-lg-4 mt-4",children:(0,o.jsx)("span",{children:(0,o.jsxs)("div",{"data-classification":"text","data-type":"text",className:"formulate-input","data-has-errors":!!j.verificationCode,"data-is-showing-errors":!!j.verificationCode,children:[(0,o.jsxs)("label",{htmlFor:"verificationCode",className:"formulate-input-label",children:[s("ForgotPassword.verificationCode","Verification Code")," *"]}),(0,o.jsx)("input",{autoComplete:"off",type:"text",name:"verificationCode",value:m.verificationCode,onChange:F,onBlur:y,placeholder:s("ForgotPassword.placeholders.verificationCode","Enter verification code"),className:"formulate-input formulate-input-element"}),(0,o.jsx)("ul",{className:"formulate-input-errors",children:j.verificationCode&&(0,o.jsx)("li",{className:"formulate-input-error",children:"string"==typeof j.verificationCode?j.verificationCode:JSON.stringify(j.verificationCode)})})]})})}),(0,o.jsx)(p,{}),(0,o.jsx)("div",{className:"col-11 col-md-7 col-lg-4 mt-4",children:(0,o.jsx)("span",{children:(0,o.jsxs)("div",{"data-classification":"text","data-type":"text",className:"formulate-input","data-has-errors":!!j.password,"data-is-showing-errors":!!j.password,children:[(0,o.jsxs)("label",{htmlFor:"password",className:"formulate-input-label",children:[s("ForgotPassword.password","New Password")," *"]}),(0,o.jsx)("input",{autoComplete:"new-password",type:"password",name:"password",value:m.password,onChange:F,onBlur:y,placeholder:s("ForgotPassword.placeholders.password","Enter your new password"),className:"formulate-input formulate-input-element"}),(0,o.jsx)("ul",{className:"formulate-input-errors",children:j.password&&(0,o.jsx)("li",{className:"formulate-input-error",children:"string"==typeof j.password?j.password:JSON.stringify(j.password)})})]})})}),(0,o.jsx)(p,{}),(0,o.jsx)("div",{className:"col-11 col-md-7 col-lg-4 mt-4",children:(0,o.jsx)("span",{children:(0,o.jsxs)("div",{"data-classification":"text","data-type":"text",className:"formulate-input","data-has-errors":!!j.confirmPassword,"data-is-showing-errors":!!j.confirmPassword,children:[(0,o.jsxs)("label",{htmlFor:"confirmPassword",className:"formulate-input-label",children:[s("ForgotPassword.confirmPassword","Confirm Password")," *"]}),(0,o.jsx)("input",{autoComplete:"new-password",type:"password",name:"confirmPassword",value:m.confirmPassword,onChange:F,onBlur:y,placeholder:s("ForgotPassword.placeholders.confirmPassword","Confirm your new password"),className:"formulate-input formulate-input-element"}),(0,o.jsx)("ul",{className:"formulate-input-errors",children:j.confirmPassword&&(0,o.jsx)("li",{className:"formulate-input-error",children:"string"==typeof j.confirmPassword?j.confirmPassword:JSON.stringify(j.confirmPassword)})})]})})}),(0,o.jsx)("div",{className:"w-100"}),(0,o.jsx)(p,{}),(0,o.jsx)(w,{isLoading:u}),(0,o.jsx)("div",{className:"mt-2 btn btn-link pl-0 read-more-toggle collapsed",onClick:()=>{a.push("/login")},style:{cursor:"pointer"},children:s("ForgotPassword.loginLink","返回登录")})]})})})})})})})})})}),(0,o.jsx)(t.A,{})]})}function w(s){let{isLoading:a}=s,{t:e}=(0,l.Bd)();return(0,o.jsx)("div",{className:"container mt-4",children:(0,o.jsx)("div",{className:"row",children:(0,o.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,o.jsx)("button",{type:"submit",form:"forgot-password-form",className:"btn btn-primary w-100",style:{padding:"12px",fontSize:"16px"},disabled:a,children:a?e("ForgotPassword.resetting","重置中..."):e("ForgotPassword.submit","Reset Password")})})})})}function p(){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"col-1"}),(0,o.jsx)("div",{className:"w-100"})]})}},43636:()=>{},65775:()=>{},77582:()=>{}},s=>{s.O(0,[5943,6086,7501,4379,2298,433,1916,2723,1242,3464,5887,3738,778,1630,8441,5964,7358],()=>s(s.s=889)),_N_E=s.O()}]);