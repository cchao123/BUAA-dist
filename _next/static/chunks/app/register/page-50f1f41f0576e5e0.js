(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2454],{16216:()=>{},18829:()=>{},22178:()=>{},64335:(e,a,s)=>{Promise.resolve().then(s.bind(s,86616))},86616:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>h});var t=s(95155),i=s(12115),r=s(35695),l=s(52548),o=s(91218),n=s(25731),c=s(55077),d=s(55887);s(16216),s(18829),s(22178);var m=s(9690),u=s(83738),p=s.n(u);function h(){let{t:e}=(0,o.Bd)(),a=(0,r.useRouter)(),{message:s}=d.A.useApp(),[u,h]=(0,i.useState)({email:"",verificationCode:"",password:"",name:"",country:"",school:""}),[x,v]=(0,i.useState)(!1),[j,y]=(0,i.useState)(!1),[N,w]=(0,i.useState)(!1),[R,C]=(0,i.useState)({email:"",verificationCode:"",password:"",name:"",country:"",school:""}),S=e=>{let{name:a,value:s}=e.target;if("password"===a){let e=s.replace(/\s/g,"").slice(0,20);h(s=>({...s,[a]:e}))}else h(e=>({...e,[a]:s}));R[a]&&C(e=>({...e,[a]:""}))},b=a=>{let{name:s,value:t}=a.target;if(t.trim())"email"!==s||/\S+@\S+\.\S+/.test(t)?C(e=>({...e,[s]:""})):C(a=>({...a,[s]:e("Register.validation.emailInvalid","Please include a valid email address")}));else{let a=e("Register.".concat(s),s.charAt(0).toUpperCase()+s.slice(1));C(t=>({...t,[s]:"".concat(a," ").concat(e("Register.validation.required","is required"))}))}},q=async()=>{if(!u.email.trim())return void C(a=>({...a,email:e("Register.validation.emailRequired","请输入邮箱地址")}));if(!/\S+@\S+\.\S+/.test(u.email))return void C(a=>({...a,email:e("Register.validation.emailInvalid","请输入有效的邮箱地址")}));try{y(!0),await n.Ay.auth.sendCode({email:u.email}),w(!0),s.success(e("Register.codeSent","验证码已发送，请查收邮箱"))}catch(r){var a,t;console.error("发送验证码失败:",r);let i=JSON.stringify(null==(t=r.response)||null==(a=t.data)?void 0:a.message)||e("Register.codeSendFailed","验证码发送失败，请重试");s.error(i)}finally{y(!1)}};async function B(e,a){let s=p().random.getBytesSync(12),t=p().cipher.createCipher("AES-GCM","uSm7LwQeR39kK0x9cPpzV2nY5HjJqMl8");t.start({iv:s,tagLength:128}),t.update(p().util.createBuffer(JSON.stringify(e),"utf8")),t.finish();let i=t.output.getBytes(),r=t.mode.tag.getBytes();return p().util.encode64(s+r+i)}let k=async()=>{try{v(!0);let t={name:u.name,email:u.email,password:u.password,agency:u.country,college:u.school,password_confirmation:u.password,verification_code:u.verificationCode,timestamp:Math.floor(Date.now()/1e3)},i=await B(t,"uSm7LwQeR39kK0x9cPpzV2nY5HjJqMl8"),r=(await n.Ay.auth.register({encrypted_data:i})).data;r.token&&(0,c.O5)(r.token),s.success(e("Register.success","注册成功！")),a.push("/login")}catch(r){var t,i;console.error("注册失败:",r);let a=JSON.stringify(null==(i=r.response)||null==(t=i.data)?void 0:t.message)||e("Register.failed","注册失败，请重试");s.error(a)}finally{v(!1)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.FormHeader,{}),(0,t.jsx)("div",{className:"my-5",children:(0,t.jsx)("div",{className:"container",children:(0,t.jsx)("div",{className:"row",children:(0,t.jsx)("div",{className:"col",children:(0,t.jsx)("div",{className:"row mt-20 contact-details",children:(0,t.jsx)("div",{className:"col",children:(0,t.jsx)("form",{id:"register-form",onSubmit:a=>{a.preventDefault(),(()=>{let a={email:"",verificationCode:"",password:"",name:"",country:"",school:""},s=!0;if(u.email.trim())/\S+@\S+\.\S+/.test(u.email)||(a.email=e("Register.validation.emailInvalid","Please include a valid email address"),s=!1);else{let t=e("Register.email","Email address");a.email="".concat(t," ").concat(e("Register.validation.required","is required")),s=!1}if(!u.verificationCode.trim()){let t=e("Register.verificationCode","Verification Code");a.verificationCode="".concat(t," ").concat(e("Register.validation.required","is required")),s=!1}if(u.password.trim())u.password.length<6?(a.password=e("Register.validation.passwordMinLength","Password must be at least 6 characters"),s=!1):u.password.length>20?(a.password=e("Register.validation.passwordMaxLength","Password must be no more than 20 characters"),s=!1):u.password.includes(" ")&&(a.password=e("Register.validation.passwordNoSpaces","Password cannot contain spaces"),s=!1);else{let t=e("Register.password","Password");a.password="".concat(t," ").concat(e("Register.validation.required","is required")),s=!1}if(!u.name.trim()){let t=e("Register.name","Your name");a.name="".concat(t," ").concat(e("Register.validation.required","is required")),s=!1}if(!u.country.trim()){let t=e("Register.country","Your country");a.country="".concat(t," ").concat(e("Register.validation.required","is required")),s=!1}if(!u.school.trim()){let t=e("Register.school","School/University");a.school="".concat(t," ").concat(e("Register.validation.required","is required")),s=!1}return C(a),s})()?k():console.log("表单验证失败，请检查输入内容")},children:(0,t.jsx)("div",{"data-classification":"contact-details","data-type":"contact-details",className:"formulate-input",children:(0,t.jsx)("div",{className:"formulate-input-wrapper",children:(0,t.jsxs)("div",{className:"row",children:[(0,t.jsx)("div",{className:"col-12",children:(0,t.jsx)("h3",{className:"text-medium",children:e("Register.title","Your register info")})}),(0,t.jsx)("div",{className:"col-11 col-md-7 col-lg-4 mt-4",children:(0,t.jsx)("span",{children:(0,t.jsxs)("div",{"data-classification":"text","data-type":"text",className:"formulate-input","data-has-errors":!!R.email,"data-is-showing-errors":!!R.email,children:[(0,t.jsxs)("label",{htmlFor:"email",className:"formulate-input-label",children:[e("Register.email","Email address")," *"]}),(0,t.jsxs)("div",{className:"d-flex",children:[(0,t.jsx)("input",{autoComplete:"off",type:"email",name:"email",value:u.email,onChange:S,onBlur:b,placeholder:e("Register.placeholders.email","e.g. example@gmail.com"),className:"formulate-input formulate-input-element flex-grow-1",style:{marginRight:"10px"}}),(0,t.jsx)("button",{type:"button",className:"btn btn-outline-primary",style:{whiteSpace:"nowrap",color:"#fff"},onClick:q,disabled:j||N,children:j?e("Register.sending","发送中..."):N?e("Register.codeSent","已发送"):e("Register.getCode","获取验证码")})]}),(0,t.jsx)("ul",{className:"formulate-input-errors",children:R.email&&(0,t.jsx)("li",{className:"formulate-input-error",children:"string"==typeof R.email?R.email:JSON.stringify(R.email)})})]})})}),(0,t.jsx)(g,{}),(0,t.jsx)("div",{className:"col-11 col-md-7 col-lg-4 mt-4",children:(0,t.jsx)("span",{children:(0,t.jsxs)("div",{"data-classification":"text","data-type":"text",className:"formulate-input","data-has-errors":!!R.verificationCode,"data-is-showing-errors":!!R.verificationCode,children:[(0,t.jsxs)("label",{htmlFor:"verificationCode",className:"formulate-input-label",children:[e("Register.verificationCode","Verification Code")," *"]}),(0,t.jsx)("input",{autoComplete:"off",type:"text",name:"verificationCode",value:u.verificationCode,onChange:S,onBlur:b,placeholder:e("Register.placeholders.verificationCode","Enter verification code"),className:"formulate-input formulate-input-element"}),(0,t.jsx)("ul",{className:"formulate-input-errors",children:R.verificationCode&&(0,t.jsx)("li",{className:"formulate-input-error",children:"string"==typeof R.verificationCode?R.verificationCode:JSON.stringify(R.verificationCode)})})]})})}),(0,t.jsx)(g,{}),(0,t.jsx)("div",{className:"col-11 col-md-7 col-lg-4 mt-4",children:(0,t.jsx)("span",{children:(0,t.jsxs)("div",{"data-classification":"text","data-type":"text",className:"formulate-input","data-has-errors":!!R.password,"data-is-showing-errors":!!R.password,children:[(0,t.jsxs)("label",{htmlFor:"password",className:"formulate-input-label",children:[e("Register.password","Password")," *"]}),(0,t.jsx)("input",{autoComplete:"new-password",type:"password",name:"password",value:u.password,onChange:S,onBlur:b,placeholder:e("Register.placeholders.password","Enter your password"),className:"formulate-input formulate-input-element"}),(0,t.jsx)("ul",{className:"formulate-input-errors",children:R.password&&(0,t.jsx)("li",{className:"formulate-input-error",children:"string"==typeof R.password?R.password:JSON.stringify(R.password)})})]})})}),(0,t.jsx)(g,{}),(0,t.jsx)("div",{className:"col-11 col-md-7 col-lg-4 mt-4",children:(0,t.jsx)("span",{children:(0,t.jsxs)("div",{"data-classification":"text","data-type":"text",className:"formulate-input","data-has-errors":!!R.name,"data-is-showing-errors":!!R.name,children:[(0,t.jsxs)("label",{htmlFor:"name",className:"formulate-input-label",children:[e("Register.name","Your name")," *"]}),(0,t.jsx)("input",{autoComplete:"off",type:"text",name:"name",value:u.name,onChange:S,onBlur:b,placeholder:e("Register.placeholders.name","e.g. John"),className:"formulate-input formulate-input-element"}),(0,t.jsx)("ul",{className:"formulate-input-errors",children:R.name&&(0,t.jsx)("li",{className:"formulate-input-error",children:"string"==typeof R.name?R.name:JSON.stringify(R.name)})})]})})}),(0,t.jsx)(g,{}),(0,t.jsx)("div",{className:"col-11 col-md-7 col-lg-4 mt-4",children:(0,t.jsx)("span",{children:(0,t.jsxs)("div",{"data-classification":"text","data-type":"text",className:"formulate-input","data-has-errors":!!R.country,"data-is-showing-errors":!!R.country,children:[(0,t.jsxs)("label",{htmlFor:"country",className:"formulate-input-label",children:[e("Register.country","Your country")," *"]}),(0,t.jsx)("input",{autoComplete:"off",type:"text",name:"country",value:u.country,onChange:S,onBlur:b,placeholder:e("Register.placeholders.country","e.g. China"),className:"formulate-input formulate-input-element"}),(0,t.jsx)("ul",{className:"formulate-input-errors",children:R.country&&(0,t.jsx)("li",{className:"formulate-input-error",children:"string"==typeof R.country?R.country:JSON.stringify(R.country)})})]})})}),(0,t.jsx)(g,{}),(0,t.jsx)("div",{className:"col-11 col-md-7 col-lg-4 mt-4",children:(0,t.jsx)("span",{children:(0,t.jsxs)("div",{"data-classification":"text","data-type":"text",className:"formulate-input","data-has-errors":!!R.school,"data-is-showing-errors":!!R.school,children:[(0,t.jsxs)("label",{htmlFor:"school",className:"formulate-input-label",children:[e("Register.school","School/University")," *"]}),(0,t.jsx)("input",{autoComplete:"off",type:"text",name:"school",value:u.school,onChange:S,onBlur:b,placeholder:e("Register.placeholders.school","e.g. Beijing University of Aeronautics and Astronautics"),className:"formulate-input formulate-input-element"}),(0,t.jsx)("ul",{className:"formulate-input-errors",children:R.school&&(0,t.jsx)("li",{className:"formulate-input-error",children:"string"==typeof R.school?R.school:JSON.stringify(R.school)})})]})})}),(0,t.jsx)("div",{className:"w-100"}),(0,t.jsx)(g,{}),(0,t.jsx)(f,{isLoading:x}),(0,t.jsx)("div",{className:"mt-2 btn btn-link pl-0 read-more-toggle collapsed",onClick:()=>{a.push("/login")},style:{cursor:"pointer"},children:e("Register.loginLink","已有账户去登录")})]})})})})})})})})})}),(0,t.jsx)(l.A,{})]})}function f(e){let{isLoading:a}=e,{t:s}=(0,o.Bd)();return(0,t.jsx)("div",{className:"container mt-4",children:(0,t.jsx)("div",{className:"row",children:(0,t.jsx)("div",{className:"col-12 col-md-6 col-lg-4",children:(0,t.jsx)("button",{type:"submit",form:"register-form",className:"btn btn-primary w-100",style:{padding:"12px",fontSize:"16px"},disabled:a,children:a?s("Register.registering","注册中..."):s("Register.submit","Register")})})})})}function g(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"col-1"}),(0,t.jsx)("div",{className:"w-100"})]})}}},e=>{e.O(0,[6297,6508,2515,4379,2298,433,1916,2723,1242,3464,5887,3738,778,1630,8441,5964,7358],()=>e(e.s=64335)),_N_E=e.O()}]);